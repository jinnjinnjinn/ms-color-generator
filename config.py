"""
MS Color Generator - è¨­å®šãƒ»å®šæ•°ï¼ˆçµ±åˆç‰ˆï¼‰
"""

import os
import re
from typing import Dict, Any, List, Tuple

# ======================= ç’°å¢ƒåˆ¤å®šï¼ˆæ–°è¦è¿½åŠ ï¼‰ =======================
# ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³èµ·å‹•æ™‚ã«ä¸€åº¦ã ã‘åˆ¤å®š
IS_HUGGING_FACE_SPACES = os.getenv("SPACE_ID") is not None

# ãƒ‡ãƒãƒƒã‚°å‡ºåŠ›
if IS_HUGGING_FACE_SPACES:
    print("ğŸŒ [ENV] Hugging Face Spaces ç’°å¢ƒã§å®Ÿè¡Œä¸­")
else:
    print("ğŸ’» [ENV] ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒã§å®Ÿè¡Œä¸­")

# ======================= ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³åŸºæœ¬è¨­å®š =======================
VERSION = "v1.4.2 beta"
MAX_LAYERS = 50  # èª­ã¿è¾¼ã¿å¯èƒ½ãªæœ€å¤§ãƒ¬ã‚¤ãƒ¤ãƒ¼æ•°

# ======================= è‰²è¨­å®š =======================
TARGET_COLOR = (255, 0, 255)  # ãƒã‚¼ãƒ³ã‚¿è‰²ã‚’ã‚¿ãƒ¼ã‚²ãƒƒãƒˆè‰²ã¨ã—ã¦æŒ‡å®šï¼ˆRGBå€¤ï¼‰
DEFAULT_GROUP_COLOR = "#aacf53"  # ãƒ¨ãƒ¢ã‚®è‰²ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ã‚°ãƒ«ãƒ¼ãƒ—è‰²ï¼‰

# ======================= ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¨­å®š =======================
MAX_RETRY_ATTEMPTS = 100  # è‰²ç”Ÿæˆã®æœ€å¤§è©¦è¡Œå›æ•°
DEFAULT_SLEEP_TIME = 1.0  # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå¾…æ©Ÿæ™‚é–“ï¼ˆç§’ï¼‰
IMAGE_CACHE_SIZE = 50     # ç”»åƒã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®æœ€å¤§ã‚µã‚¤ã‚º
MEMORY_CLEANUP_INTERVAL = 10  # ãƒ¡ãƒ¢ãƒªã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—é–“éš”ï¼ˆåˆ†ï¼‰

# ======================= UIåŸºæœ¬è¨­å®š =======================
GALLERY_COLUMNS = 4       # ã‚®ãƒ£ãƒ©ãƒªãƒ¼ã®åˆ—æ•°
GALLERY_ROWS = 1         # ã‚®ãƒ£ãƒ©ãƒªãƒ¼ã®è¡Œæ•°
MAIN_IMAGE_HEIGHT = 480  # ãƒ¡ã‚¤ãƒ³ç”»åƒã®é«˜ã•ï¼ˆãƒ”ã‚¯ã‚»ãƒ«ï¼‰
PATTERN_GALLERY_HEIGHT = 250  # ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚®ãƒ£ãƒ©ãƒªãƒ¼ã®é«˜ã•ï¼ˆãƒ”ã‚¯ã‚»ãƒ«ï¼‰

# ======================= ãƒ•ã‚¡ã‚¤ãƒ«ãƒ»ãƒ•ã‚©ãƒ«ãƒ€è¨­å®š =======================
FILE_PREFIX = "composite"
SAVE_DIR = "./output"      # ä¿å­˜ãƒ•ã‚©ãƒ«ãƒ€
LAYER_DIR = "./layer"      # ãƒ¬ã‚¤ãƒ¤ãƒ¼èª­ã¿è¾¼ã¿ãƒ•ã‚©ãƒ«ãƒ€
CONFIG_FILE = "grouping.txt"  # è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«å
BACKUP_DIR = "./oldpy"     # ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚©ãƒ«ãƒ€

# ======================= ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ =======================
ERROR_MESSAGES = {
    "FILE_NOT_FOUND": "ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“",
    "INVALID_COLOR": "ç„¡åŠ¹ãªè‰²å½¢å¼ã§ã™",
    "MEMORY_ERROR": "ãƒ¡ãƒ¢ãƒªã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ",
    "CONFIG_ERROR": "è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼",
    "RESTART_ERROR": "å†èµ·å‹•ã«å¤±æ•—ã—ã¾ã—ãŸ"
}

# ======================= Phase 1: HSVå¤‰åŒ–ãƒ‘ã‚¿ãƒ¼ãƒ³è¨­å®š =======================
# HSVè‰²ç›¸ãƒ»å½©åº¦ãƒ»æ˜åº¦ã®å¤‰åŒ–ãƒ‘ã‚¿ãƒ¼ãƒ³å®šç¾©
HSV_VARIATION_PATTERNS = {
    # ç­‰é–“éš”ãƒ¢ãƒ¼ãƒ‰ã§ã®å¤‰åŒ–é‡ï¼ˆåº¦ or %ï¼‰
    "hue_equal_steps": [-45, -15, 15, 45],           # è‰²ç›¸ã®ç­‰é–“éš”å¤‰åŒ–é‡ï¼ˆåº¦ï¼‰
    "saturation_equal_steps": [-30, -10, 10, 30],    # å½©åº¦ã®ç­‰é–“éš”å¤‰åŒ–é‡ï¼ˆ%ï¼‰
    "brightness_equal_steps": [-30, -10, 10, 30],    # æ˜åº¦ã®ç­‰é–“éš”å¤‰åŒ–é‡ï¼ˆ%ï¼‰
    
    # ãƒ©ãƒ³ãƒ€ãƒ ãƒ¢ãƒ¼ãƒ‰ã§ã®å¤‰åŒ–ç¯„å›²
    "hue_random_range": (-180, 180),        # è‰²ç›¸ãƒ©ãƒ³ãƒ€ãƒ å¤‰åŒ–ç¯„å›²ï¼ˆåº¦ï¼‰
    "saturation_random_range": (-50, 50),   # å½©åº¦ãƒ©ãƒ³ãƒ€ãƒ å¤‰åŒ–ç¯„å›²ï¼ˆ%ï¼‰
    "brightness_random_range": (-50, 50),   # æ˜åº¦ãƒ©ãƒ³ãƒ€ãƒ å¤‰åŒ–ç¯„å›²ï¼ˆ%ï¼‰
    
    # ãƒ‘ã‚¿ãƒ¼ãƒ³ç”Ÿæˆè¨­å®š
    "pattern_count": 4,                      # ç”Ÿæˆã™ã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³æ•°
    "pattern_variation_retry": 10            # ãƒ‘ã‚¿ãƒ¼ãƒ³ç”Ÿæˆæ™‚ã®é‡è¤‡å›é¿è©¦è¡Œå›æ•°
}

# ======================= Phase 1: UIãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆè¨­å®š =======================
# Gradio UIã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆãƒ»å¯¸æ³•è¨­å®š
UI_LAYOUT = {
    # ã‚«ãƒ©ãƒ å¹…æ¯”ç‡è¨­å®šï¼ˆGradio scaleå€¤ï¼‰
    "main_content_scale": 5,      # ãƒ¡ã‚¤ãƒ³ç”»åƒã‚¨ãƒªã‚¢ã®å¹…æ¯”ç‡
    "picker_control_scale": 5,    # ã‚«ãƒ©ãƒ¼ãƒ”ãƒƒã‚«ãƒ¼ãƒ»åˆ¶å¾¡ã‚¨ãƒªã‚¢ã®å¹…æ¯”ç‡
    "gallery_scale": 6,           # ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚®ãƒ£ãƒ©ãƒªãƒ¼ã‚¨ãƒªã‚¢ã®å¹…æ¯”ç‡
    "button_control_scale": 2,    # æ“ä½œãƒœã‚¿ãƒ³ã‚¨ãƒªã‚¢ã®å¹…æ¯”ç‡
    "margin_scale": 1,            # å·¦å³ä½™ç™½ã‚¨ãƒªã‚¢ã®å¹…æ¯”ç‡
    
    # ç”»åƒè¡¨ç¤ºã‚µã‚¤ã‚º
    "main_image_height": 480,     # ãƒ¡ã‚¤ãƒ³ç”»åƒè¡¨ç¤ºé«˜ã•ï¼ˆãƒ”ã‚¯ã‚»ãƒ«ï¼‰
    "pattern_gallery_height": 250, # ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚®ãƒ£ãƒ©ãƒªãƒ¼é«˜ã•ï¼ˆãƒ”ã‚¯ã‚»ãƒ«ï¼‰
    
    # ã‚®ãƒ£ãƒ©ãƒªãƒ¼è¨­å®š
    "gallery_columns": 4,         # ã‚®ãƒ£ãƒ©ãƒªãƒ¼è¡¨ç¤ºåˆ—æ•°
    "gallery_rows": 1,            # ã‚®ãƒ£ãƒ©ãƒªãƒ¼è¡¨ç¤ºè¡Œæ•°
    "gallery_object_fit": "contain", # ç”»åƒãƒ•ã‚£ãƒƒãƒˆæ–¹å¼
    
    # ãƒœã‚¿ãƒ³ã‚µã‚¤ã‚º
    "small_button_size": "sm",    # å°ãƒœã‚¿ãƒ³ã‚µã‚¤ã‚º
    "large_button_size": "lg"     # å¤§ãƒœã‚¿ãƒ³ã‚µã‚¤ã‚º
}

# ======================= Phase 1: ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼è¨­å®š =======================
# å„ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã®åˆæœŸå€¤ãƒ»ç¯„å›²ãƒ»ã‚¹ãƒ†ãƒƒãƒ—è¨­å®š
SLIDER_CONFIGS: Dict[str, Dict[str, Any]] = {
    # å½©åº¦é–¢é€£ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼
    "saturation_base": {
        "min": 0, "max": 100, "value": 50, "step": 1,
        "label": "å½©åº¦åŸºæº– (%)",
        "description": "ç”Ÿæˆè‰²ã®å½©åº¦ä¸­å¿ƒå€¤"
    },
    "saturation_range": {
        "min": 0, "max": 50, "value": 15, "step": 1,
        "label": "å½©åº¦èª¤å·®ç¯„å›² (%)",
        "description": "å½©åº¦åŸºæº–å€¤ã‹ã‚‰ã®èª¤å·®ç¯„å›²ï¼ˆÂ±ã“ã®å€¤ï¼‰"
    },
    
    # æ˜åº¦é–¢é€£ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼
    "brightness_base": {
        "min": 0, "max": 100, "value": 60, "step": 1,
        "label": "æ˜åº¦åŸºæº– (%)",
        "description": "ç”Ÿæˆè‰²ã®æ˜åº¦ä¸­å¿ƒå€¤"
    },
    "brightness_range": {
        "min": 0, "max": 50, "value": 15, "step": 1,
        "label": "æ˜åº¦èª¤å·®ç¯„å›² (%)",
        "description": "æ˜åº¦åŸºæº–å€¤ã‹ã‚‰ã®èª¤å·®ç¯„å›²ï¼ˆÂ±ã“ã®å€¤ï¼‰"
    },
    
    # è‰²ç›¸é–¢é€£ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼
    "hue_center": {
        "min": 0, "max": 360, "value": 180, "step": 5,
        "label": "ä¸­å¿ƒè‰²ç›¸ (åº¦)",
        "description": "ç”Ÿæˆè‰²ã®è‰²ç›¸ä¸­å¿ƒå€¤ï¼ˆ0-360åº¦ï¼‰"
    },
    "hue_range": {
        "min": 1, "max": 180, "value": 60, "step": 5,
        "label": "è‰²ç›¸èª¤å·®ç¯„å›² (åº¦)",
        "description": "è‰²ç›¸ä¸­å¿ƒå€¤ã‹ã‚‰ã®èª¤å·®ç¯„å›²ï¼ˆÂ±ã“ã®å€¤ï¼‰"
    },
    
    # è‰²æ•°ãƒ»è·é›¢è¨­å®š
    "color_count": {
        "min": 2, "max": 10, "value": 4, "step": 1,
        "label": "ç”Ÿæˆè‰²æ•°",
        "description": "ä¸€åº¦ã«ç”Ÿæˆã™ã‚‹è‰²ã®æ•°"
    },
    "min_hue_distance": {
        "min": 0, "max": 180, "value": 30, "step": 5,
        "label": "æœ€å°è‰²ç›¸è·é›¢ (åº¦)",
        "description": "ç”Ÿæˆè‰²åŒå£«ã®æœ€å°è‰²ç›¸è·é›¢"
    },
    
    # HSVã‚·ãƒ•ãƒˆã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ï¼ˆãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è‰²èª¿æ•´ç”¨ï¼‰
    "hue_shift": {
        "min": -180, "max": 180, "value": 0, "step": 5,
        "label": "è‰²ç›¸ã‚·ãƒ•ãƒˆ (åº¦)",
        "description": "å…¨è‰²ã®è‰²ç›¸ã‚’ä¸€æ‹¬ã‚·ãƒ•ãƒˆ"
    },
    "saturation_shift": {
        "min": -100, "max": 100, "value": 0, "step": 5,
        "label": "å½©åº¦ã‚·ãƒ•ãƒˆ (%)",
        "description": "å…¨è‰²ã®å½©åº¦ã‚’ä¸€æ‹¬ã‚·ãƒ•ãƒˆ"
    },
    "brightness_shift": {
        "min": -100, "max": 100, "value": 0, "step": 5,
        "label": "æ˜åº¦ã‚·ãƒ•ãƒˆ (%)",
        "description": "å…¨è‰²ã®æ˜åº¦ã‚’ä¸€æ‹¬ã‚·ãƒ•ãƒˆ"
    }
}

# ======================= Phase 2: è‰²é–¢é€£è¨­å®š =======================
# è‰²å‡¦ç†ãƒ»è¡¨ç¤ºã«é–¢ã™ã‚‹è¨­å®š
COLOR_SETTINGS = {
    # ç‰¹æ®Šè‰²å®šç¾©
    "hot_pink": "#ff69b4",              # ãƒ”ãƒ³ã‚¯è‰²ï¼ˆæ–°ã‚°ãƒ«ãƒ¼ãƒ—è¿½åŠ æ™‚ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³è‰²ï¼‰
    "black_fallback": "#000000",        # HSVå¤‰æ›ã‚¨ãƒ©ãƒ¼æ™‚ã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯è‰²
    
    # é€æ˜åº¦ãƒ»è¡¨ç¤ºè¨­å®š
    "overlay_alpha": 0.5,               # ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚¯ãƒªãƒƒã‚¯æ™‚ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤é€æ˜åº¦ï¼ˆ0.0-1.0ï¼‰
    "default_rgb_fallback": (170, 207, 83),  # RGBå¤‰æ›ã‚¨ãƒ©ãƒ¼æ™‚ã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å€¤
    
    # ã‚¨ãƒ©ãƒ¼æ™‚ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯è‰²ã‚»ãƒƒãƒˆ
    "error_fallback_colors": ["#ff0000", "#00ff00", "#0000ff", "#ffff00"],  # èµ¤ã€ç·‘ã€é’ã€é»„
    
    # HSVè¡¨ç¤ºç²¾åº¦
    "hue_display_precision": 0,         # è‰²ç›¸è¡¨ç¤ºå°æ•°ç‚¹æ¡æ•°
    "saturation_display_precision": 0,  # å½©åº¦è¡¨ç¤ºå°æ•°ç‚¹æ¡æ•°
    "brightness_display_precision": 0   # æ˜åº¦è¡¨ç¤ºå°æ•°ç‚¹æ¡æ•°
}

# ======================= Phase 2: ç”»åƒå‡¦ç†è¨­å®š =======================
# ç”»åƒèª­ã¿è¾¼ã¿ãƒ»å‡¦ç†ã«é–¢ã™ã‚‹è¨­å®š
IMAGE_SETTINGS = {
    # ãƒ€ãƒŸãƒ¼ç”»åƒè¨­å®šï¼ˆãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆï¼‰
    "dummy_image_size": (512, 512),     # ãƒ€ãƒŸãƒ¼ç”»åƒã‚µã‚¤ã‚ºï¼ˆwidth, heightï¼‰
    "dummy_image_color": (0, 0, 0, 0),  # ãƒ€ãƒŸãƒ¼ç”»åƒè‰²ï¼ˆRGBAï¼‰
    "default_image_mode": "RGBA",       # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆç”»åƒãƒ¢ãƒ¼ãƒ‰
    
    # ãƒ•ã‚¡ã‚¤ãƒ«å‡¦ç†è¨­å®š
    "file_encoding": "utf-8",           # è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°
    "layer_file_pattern": r"layer(\d+)\.png",  # ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«åæ­£è¦è¡¨ç¾ãƒ‘ã‚¿ãƒ¼ãƒ³
    "layer_file_flags": re.IGNORECASE,  # ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«æ¤œç´¢ãƒ•ãƒ©ã‚°
    
    # ç”»åƒã‚­ãƒ£ãƒƒã‚·ãƒ¥è¨­å®š
    "enable_image_cache": True,         # ç”»åƒã‚­ãƒ£ãƒƒã‚·ãƒ¥æœ‰åŠ¹åŒ–
    "cache_cleanup_threshold": 50       # ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—é–¾å€¤
}

# ======================= Phase 2: ã‚·ã‚¹ãƒ†ãƒ è¨­å®š =======================
# ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å‹•ä½œã«é–¢ã™ã‚‹ã‚·ã‚¹ãƒ†ãƒ è¨­å®š
SYSTEM_SETTINGS = {
    # è‰²ç”Ÿæˆãƒ»å‡¦ç†è¨­å®š
    "max_color_generation_attempts": 100,  # è‰²ç”Ÿæˆæœ€å¤§è©¦è¡Œå›æ•°
    "flag_reset_delay": 1.0,               # ãƒ—ãƒ­ã‚°ãƒ©ãƒ çš„æ›´æ–°ãƒ•ãƒ©ã‚°ãƒªã‚»ãƒƒãƒˆé…å»¶æ™‚é–“ï¼ˆç§’ï¼‰
    
    # ãƒ•ã‚¡ã‚¤ãƒ«ãƒ»ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆè¨­å®š
    "timestamp_format": "%Y%m%d_%H%M%S",   # ãƒ•ã‚¡ã‚¤ãƒ«ä¿å­˜æ™‚ã®ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
    "group_name_format": "GROUP{i}",       # ã‚°ãƒ«ãƒ¼ãƒ—åãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼ˆ{i}ã¯ç•ªå·ï¼‰
    "default_group_name": "GROUP0",        # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚°ãƒ«ãƒ¼ãƒ—å
    
    # ã‚¹ãƒ¬ãƒƒãƒ‰ãƒ»ä¸¦è¡Œå‡¦ç†è¨­å®š
    "thread_daemon_mode": True,            # ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã‚¹ãƒ¬ãƒƒãƒ‰ã®ãƒ‡ãƒ¼ãƒ¢ãƒ³ãƒ¢ãƒ¼ãƒ‰
    "memory_cleanup_enabled": True         # ãƒ¡ãƒ¢ãƒªã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—æœ‰åŠ¹åŒ–
}

# ======================= Phase 3: å†èµ·å‹•ãƒ»å¾©æ—§è¨­å®š =======================
# ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å†èµ·å‹•ãƒ»å¾©æ—§å‡¦ç†ã®è¨­å®š
RESTART_SETTINGS = {
    # å†èµ·å‹•å‡¦ç†ã‚¿ã‚¤ãƒŸãƒ³ã‚°
    "restart_wait_ms": 2500,              # å†èµ·å‹•é–‹å§‹å¾…æ©Ÿæ™‚é–“ï¼ˆãƒŸãƒªç§’ï¼‰
    "recovery_check_interval_ms": 1000,   # ã‚µãƒ¼ãƒãƒ¼å¾©æ—§ç¢ºèªé–“éš”ï¼ˆãƒŸãƒªç§’ï¼‰
    "max_recovery_attempts": 30,          # ã‚µãƒ¼ãƒãƒ¼å¾©æ—§ç¢ºèªæœ€å¤§è©¦è¡Œå›æ•°
    
    # ç’°å¢ƒå¤‰æ•°è¨­å®š
    "restart_flag_env": "MS_COLOR_RESTART",  # å†èµ·å‹•ãƒ•ãƒ©ã‚°ç’°å¢ƒå¤‰æ•°å
    "restart_flag_value": "True"            # å†èµ·å‹•ãƒ•ãƒ©ã‚°å€¤
}

# ======================= Phase 3: ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—è¨­å®š =======================
# ã‚³ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æ©Ÿèƒ½ã®è¨­å®š
BACKUP_SETTINGS = {
    # ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§
    "target_files": [
        "config.py", "models.py", "presets.py", "color_utils.py",
        "layer_manager.py", "ui.py", "ui_handlers.py", "ui_state.py", 
        "ui_utils.py", "ui_generators.py", "main.py", "grouping.txt"
    ],
    
    # ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚©ãƒ«ãƒ€è¨­å®š
    "backup_folder_format": "backup_{timestamp}",  # ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚©ãƒ«ãƒ€åãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
    "backup_timestamp_format": "%Y%m%d_%H%M%S",    # ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ç”¨ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
    
    # ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—å‹•ä½œè¨­å®š
    "preserve_permissions": True,                   # ãƒ•ã‚¡ã‚¤ãƒ«æ¨©é™ä¿æŒ
    "create_backup_log": True                       # ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ­ã‚°å‡ºåŠ›
}

# ======================= UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆé¸æŠè‚¢ =======================
# ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ãƒ»é¸æŠè‚¢ã®å®šç¾©
UI_CHOICES = {
    # æ–°ã‚°ãƒ«ãƒ¼ãƒ—è‰²é¸æŠè‚¢
    "new_group_colors": ["ãƒ¨ãƒ¢ã‚®è‰²", "ãƒ”ãƒ³ã‚¯è‰²"],
    
    # HSVå¤‰åŒ–ãƒ¢ãƒ¼ãƒ‰é¸æŠè‚¢
    "variation_modes": ["ç­‰é–“éš”", "ãƒ©ãƒ³ãƒ€ãƒ "],
    
    # ãƒ—ãƒªã‚»ãƒƒãƒˆåä¸€è¦§ï¼ˆpresets.pyã¨åŒæœŸï¼‰
    "preset_names": ["ãƒ€ãƒ«", "ãƒ©ã‚¤ãƒˆ ã‚°ãƒ¬ã‚¤ãƒƒã‚·ãƒ¥", "ãƒšãƒ¼ãƒ«", "ãƒ“ãƒ“ãƒƒãƒ‰", "ã‚¢ãƒ¼ã‚¹ ã‚«ãƒ©ãƒ¼", "ãƒ¢ãƒã‚¯ãƒ­"]
}

# ======================= é–‹ç™ºãƒ»ãƒ‡ãƒãƒƒã‚°è¨­å®š =======================
# é–‹ç™ºæ™‚ã®ãƒ‡ãƒãƒƒã‚°ãƒ»ãƒ­ã‚°è¨­å®š
DEBUG_SETTINGS = {
    # ãƒ‡ãƒãƒƒã‚°å‡ºåŠ›åˆ¶å¾¡
    "enable_debug_prints": True,          # ãƒ‡ãƒãƒƒã‚°ãƒ—ãƒªãƒ³ãƒˆå‡ºåŠ›æœ‰åŠ¹åŒ–
    "debug_emoji_enabled": True,          # ãƒ‡ãƒãƒƒã‚°çµµæ–‡å­—è¡¨ç¤ºæœ‰åŠ¹åŒ–
    
    # ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«è¨­å®š
    "log_level": "DEBUG",                 # ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ï¼ˆDEBUG/INFO/WARNING/ERRORï¼‰
    "log_format": "%(asctime)s - %(name)s - %(levelname)s - %(message)s",
    
    # ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–
    "measure_performance": False,         # ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¸¬å®šæœ‰åŠ¹åŒ–
    "profile_memory_usage": False         # ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒªãƒ³ã‚°
}

# ======================= è¨­å®šå€¤ã‚¢ã‚¯ã‚»ã‚¹ç”¨ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•° =======================

def get_slider_config(slider_name: str) -> Dict[str, Any]:
    """ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼è¨­å®šã‚’å–å¾—
    
    Args:
        slider_name: ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼å
        
    Returns:
        ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼è¨­å®šè¾æ›¸
    """
    return SLIDER_CONFIGS.get(slider_name, {})

def get_hsv_variation_steps(variation_type: str) -> List[int]:
    """HSVå¤‰åŒ–ã‚¹ãƒ†ãƒƒãƒ—ã‚’å–å¾—
    
    Args:
        variation_type: å¤‰åŒ–ã‚¿ã‚¤ãƒ—ï¼ˆhue/saturation/brightnessï¼‰
        
    Returns:
        å¤‰åŒ–ã‚¹ãƒ†ãƒƒãƒ—ã®ãƒªã‚¹ãƒˆ
    """
    key_map = {
        "hue": "hue_equal_steps",
        "saturation": "saturation_equal_steps", 
        "brightness": "brightness_equal_steps"
    }
    key = key_map.get(variation_type, "hue_equal_steps")
    return HSV_VARIATION_PATTERNS.get(key, [-45, -15, 15, 45])

def get_hsv_random_range(variation_type: str) -> Tuple[int, int]:
    """HSVãƒ©ãƒ³ãƒ€ãƒ å¤‰åŒ–ç¯„å›²ã‚’å–å¾—
    
    Args:
        variation_type: å¤‰åŒ–ã‚¿ã‚¤ãƒ—ï¼ˆhue/saturation/brightnessï¼‰
        
    Returns:
        å¤‰åŒ–ç¯„å›²ã®ã‚¿ãƒ—ãƒ«ï¼ˆmin, maxï¼‰
    """
    key_map = {
        "hue": "hue_random_range",
        "saturation": "saturation_random_range",
        "brightness": "brightness_random_range"
    }
    key = key_map.get(variation_type, "hue_random_range")
    return HSV_VARIATION_PATTERNS.get(key, (-180, 180))